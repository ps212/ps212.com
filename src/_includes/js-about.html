<script>

    // imgix responsive background-image
    // https://gist.github.com/croxton/9cfa0cca85fbb5f135441653a5b1dd9f
    var $img = $(".js-img");
    if ($img.length) {
      // triggered whenever an image is loaded, including on resize
      $img.each(function() {
        $(this).on('load', function(){
          // legacy browser support
          // picturefill();
          // fallback to src for browsers without srcset support
          var src = $(this).prop('currentSrc') || $(this).prop('src');
          // set the background image for the parent
          var $parent = $(this).parent();
          $parent.css('backgroundImage', 'url('+src+')');
        });
      })
    }

    var windowWidth = $(window).width();

    $(function() {
      // on load
      var main = $('main');
      setTimeout(function(){
        $(main).fadeIn().removeClass('load').addClass('loaded');
      }, 250);

      var margin = $('.square-index').first().css('margin-right');
      var squares = $('.square-index');

      $(squares).each( function( index, element ){
        $(this).css('margin-bottom', margin);
      });

      // on resize
      window.onresize = function(){
        // actual resize? http://tinyurl.com/qaoajzu
        if ($(window).width() != windowWidth) {
          var main = $('main');
          $(main).removeClass('loaded').addClass('load');
          setTimeout(function(){
            $(main).fadeIn().removeClass('load').addClass('loaded');
          }, 250);
        }

        var margin = $('.square-index').first().css('margin-right');
        var squares = $('.square-index');

        $(squares).each( function( index, element ){
          $(this).css('margin-bottom', margin);
        });


      }
    });
  </script>